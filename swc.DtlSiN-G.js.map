{"version":3,"file":"swc.DcwnPka8.js","sources":["../../../../2nd-gen/packages/core/dist/controllers/language-resolution.js"],"sourcesContent":["const o = Symbol(\n  \"language resolver updated\"\n), s = /* @__PURE__ */ new Set();\nlet n;\nfunction r(a) {\n  return s.add(a), n || (n = new MutationObserver(() => {\n    for (const e of s)\n      e();\n  }), n.observe(document.documentElement, {\n    attributes: !0,\n    attributeFilter: [\"lang\"]\n  })), () => {\n    s.delete(a), s.size === 0 && (n == null || n.disconnect(), n = void 0);\n  };\n}\nclass g {\n  constructor(e) {\n    this.language = this.getDocumentLanguage(), this.host = e, this.host.addController(this);\n  }\n  /**\n   * Reads language from document and validates. Used for initial value and\n   * when syncing from `<html lang>` changes.\n   */\n  getDocumentLanguage() {\n    const e = document.documentElement.lang || navigator.language || \"en-US\";\n    try {\n      return Intl.DateTimeFormat.supportedLocalesOf([e]), e;\n    } catch (t) {\n      return \"en-US\";\n    }\n  }\n  hostConnected() {\n    this.resolveLanguage(), this.removeLangListener = r(this.handleLangChange.bind(this));\n  }\n  hostDisconnected() {\n    var e, t;\n    (e = this.unsubscribe) == null || e.call(this), this.unsubscribe = void 0, (t = this.removeLangListener) == null || t.call(this), this.removeLangListener = void 0;\n  }\n  /**\n   * Called by the shared observer when `<html lang>` changes.\n   * Skipped when a provider (e.g. sp-theme) is the source of truth.\n   */\n  handleLangChange() {\n    if (this.unsubscribe)\n      return;\n    const e = this.getDocumentLanguage();\n    if (e === this.language)\n      return;\n    const t = this.language;\n    this.language = e, this.host.requestUpdate(o, t);\n  }\n  /**\n   * Resolves the language: syncs from document, then queries for a provider\n   * (e.g. sp-theme) via 'sp-language-context'. If a provider calls the\n   * callback, it becomes the source of truth until disconnected.\n   *\n   * @private\n   */\n  resolveLanguage() {\n    this.language = this.getDocumentLanguage();\n    const e = new CustomEvent(\n      \"sp-language-context\",\n      {\n        bubbles: !0,\n        composed: !0,\n        detail: {\n          callback: (t, i) => {\n            const u = this.language;\n            this.language = t, this.unsubscribe = i, this.host.requestUpdate(o, u);\n          }\n        },\n        cancelable: !0\n      }\n    );\n    this.host.dispatchEvent(e);\n  }\n}\nexport {\n  g as LanguageResolutionController,\n  o as languageResolverUpdatedSymbol\n};\n//# sourceMappingURL=language-resolution.js.map\n"],"names":["o","Symbol","s","Set","n","g","constructor","e","this","language","getDocumentLanguage","host","addController","document","documentElement","lang","navigator","Intl","DateTimeFormat","supportedLocalesOf","t","hostConnected","a","resolveLanguage","removeLangListener","handleLangChange","bind","add","MutationObserver","observe","attributes","attributeFilter","delete","size","disconnect","hostDisconnected","unsubscribe","call","requestUpdate","CustomEvent","bubbles","composed","detail","callback","i","u","cancelable","dispatchEvent"],"mappings":"AAkCa,MAAAA,EAAgCC,OAC3C,6BAcIC,EAAA,IAAgBC,IACtB,IAAIC,EA+DG,MAAMC,EAeXC,WAAAA,CAAYC,GARZC,KAAAC,SAAWD,KAAKE,sBASdF,KAAKG,KAAOJ,EACZC,KAAKG,KAAKC,cAAcJ,KAC1B,CAMQE,mBAAAA,GACN,MAAMH,EAAMM,SAASC,gBAAgBC,MAAQC,UAAUP,UAAY,QACnE,IACE,OAAAQ,KAAKC,eAAeC,mBAAmB,CAACZ,IACjCA,CACT,CAAA,MAAQa,GACN,MAAO,OACT,CACF,CAEOC,aAAAA,GA/FT,IAAyBC,EAgGrBd,KAAKe,kBACLf,KAAKgB,oBAjGgBF,EAiGqBd,KAAKiB,iBAAiBC,KAAKlB,MAhGvEN,EAAUyB,IAAIL,GAETlB,IACHA,EAAiB,IAAIwB,iBAAiB,KACpC,IAAA,MAAWrB,KAAML,EACfK,MAGJH,EAAeyB,QAAQhB,SAASC,gBAAiB,CAC/CgB,YAAY,EACZC,gBAAiB,CAAC,WAIf,KACL7B,EAAU8B,OAAOV,GACM,IAAnBpB,EAAU+B,OACZ,MAAA7B,GAAAA,EAAgB8B,aAChB9B,OAAiB,IA+ErB,CAEO+B,gBAAAA,GAxJT,IAAA5B,EAAAa,EAyJI,OAAAb,EAAAC,KAAK4B,cAAL7B,EAAA8B,WACA7B,KAAK4B,iBAAc,EACnB,OAAAhB,OAAKI,qBAALJ,EAAAiB,KAAA7B,MACAA,KAAKgB,wBAAqB,CAC5B,CAMQC,gBAAAA,GACN,GAAIjB,KAAK4B,YACP,OAEF,MAAM7B,EAAOC,KAAKE,sBAClB,GAAIH,IAASC,KAAKC,SAChB,OAEF,MAAMW,EAAWZ,KAAKC,SACtBD,KAAKC,SAAWF,EAChBC,KAAKG,KAAK2B,cAActC,EAA+BoB,EACzD,CASQG,eAAAA,GACNf,KAAKC,SAAWD,KAAKE,sBACrB,MAAMH,EAAkB,IAAIgC,YAC1B,sBACA,CACEC,SAAS,EACTC,UAAU,EACVC,OAAQ,CACNC,SAAUA,CAACvB,EAAcwB,KACvB,MAAMC,EAAWrC,KAAKC,SACtBD,KAAKC,SAAWW,EAChBZ,KAAK4B,YAAcQ,EACnBpC,KAAKG,KAAK2B,cAActC,EAA+B6C,KAG3DC,YAAY,IAGhBtC,KAAKG,KAAKoC,cAAcxC,EAC1B"}