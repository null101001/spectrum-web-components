<html><head></head><body><sp-tab-panel class="section" value="overview"> <div class="headerContainer spectrum-Typography"><h2 id="description" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeL">Description</h2> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeL" href="#description"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Description</span></sp-link><sp-divider size="l"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">In cases where you choose to lazily register custom element definitions across the lifecycle of your application, delaying certain functionality until that registration is complete can be beneficial. To normalize management of this process, a <code class="spectrum-Code">DependencyManagerController</code> can be added to your custom element.</p> <p class="spectrum-Body spectrum-Body--sizeM">Use the <code class="spectrum-Code">add()</code> method to inform the manager which custom element tag names you need to be defined before doing some action. When the elements you have provided to the manager are available, the controller will request an update to your host element and surface a <code class="spectrum-Code">loaded</code> boolean to clarify the current load state of the managed dependencies.</p> <div class="headerContainer spectrum-Typography"><h3 id="usage" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeM">Usage</h3> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeM" href="#usage"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Usage</span></sp-link><sp-divider size="m"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM"><sp-link href="https://www.npmjs.com/package/@spectrum-web-components/reactive-controllers"><img src="https://img.shields.io/npm/v/@spectrum-web-components/reactive-controllers?style=for-the-badge" alt="See it on NPM!"></sp-link> <sp-link href="https://bundlephobia.com/result?p=@spectrum-web-components/reactive-controllers"><img src="https://img.shields.io/bundlephobia/minzip/@spectrum-web-components/reactive-controllers?style=for-the-badge" alt="How big is this package in your project?"></sp-link></p> <code-example preprocessed="preprocessed"><pre slot="code">yarn add @spectrum-web-components/reactive-controllers
</pre></code-example> <p class="spectrum-Body spectrum-Body--sizeM">Import the <code class="spectrum-Code">DependencyManagerController</code> via:</p> <code-example preprocessed="preprocessed"><pre slot="code">import { DependencyManagerController } from '@spectrum-web-components/reactive-controllers/DependencyManager.js';
</pre></code-example> <div class="headerContainer spectrum-Typography"><h2 id="example" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeL">Example</h2> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeL" href="#example"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Example</span></sp-link><sp-divider size="l"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">A <code class="spectrum-Code">Host</code> element that renders a different message depending on the <code class="spectrum-Code">loaded</code> state of the <code class="spectrum-Code">&lt;some-heavy-element&gt;</code> dependency in the following custom element definition:</p> <code-example class="language-js" preprocessed="preprocessed"><pre class="language-js" slot="code"><span class="token keyword">import</span> <span class="token punctuation">{</span> html<span class="token punctuation">,</span> LitElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lit'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> DependencyManagerController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@spectrum-web-components/reactive-controllers/DependencyManager.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'@spectrum-web-components/button/sp-button.js'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Host</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span>
    dependencyManager <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DependencyManagerController</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    state <span class="token operator">=</span> <span class="token string">'initial'</span><span class="token punctuation">;</span>

    <span class="token function">forwardState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'heavy'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> isInitialState <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token string">'initial'</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>isInitialState <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>dependencyManager<span class="token punctuation">.</span>loaded<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isInitialState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// When not in the initial state, this element depends on &lt;some-heavy-element&gt;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>dependencyManager<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">'some-heavy-element'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// Lazily load that element</span>
                <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'path/to/register/some-heavy-element.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
                &lt;sp-button
                    @click=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>forwardState<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                    ?pending=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token operator">!</span>isInitialState <span class="token operator">&amp;&amp;</span>
                    <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>dependencyManager<span class="token punctuation">.</span>loaded<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
                &gt;
                    Go to next state
                &lt;/sp-button&gt;
            </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// &lt;some-heavy-element&gt; has now been loaded and can be rendered</span>
            <span class="token keyword">return</span> html<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
                &lt;some-heavy-element&gt;&lt;/some-heavy-element&gt;
            </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></code-example> </sp-tab-panel></body></html>