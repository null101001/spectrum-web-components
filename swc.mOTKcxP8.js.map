{"version":3,"file":"swc.3TR_KQc7.js","sources":["../../../packages/overlay/src/AbstractOverlay.js","../../../packages/overlay/src/overlay-timer.js","../../../tools/shared/src/reparent-children.js"],"sourcesContent":["\"use strict\";import{SpectrumElement as g}from\"@spectrum-web-components/base\";import{reparentChildren as b}from\"@spectrum-web-components/shared/src/reparent-children.js\";import{OverlayTimer as O}from\"./overlay-timer.js\";export const overlayTimer=new O,noop=()=>{},guaranteedAllTransitionend=(i,v,e)=>{const r=new AbortController,n=new Map,a=()=>{r.abort(),e()};let m,l;const t=requestAnimationFrame(()=>{m=requestAnimationFrame(()=>{l=requestAnimationFrame(()=>{a()})})}),p=o=>{o.target===i&&(n.set(o.propertyName,n.get(o.propertyName)-1),n.get(o.propertyName)||n.delete(o.propertyName),n.size===0&&a())},d=o=>{o.target===i&&(n.has(o.propertyName)||n.set(o.propertyName,0),n.set(o.propertyName,n.get(o.propertyName)+1),cancelAnimationFrame(t),cancelAnimationFrame(m),cancelAnimationFrame(l))};i.addEventListener(\"transitionrun\",d,{signal:r.signal}),i.addEventListener(\"transitionend\",p,{signal:r.signal}),i.addEventListener(\"transitioncancel\",p,{signal:r.signal}),v()};export function nextFrame(){return new Promise(i=>requestAnimationFrame(()=>i()))}export class AbstractOverlay extends g{constructor(){super(...arguments);this.dispose=noop;this.offset=0;this.willPreventClose=!1}async applyFocus(e,r){}get delayed(){return!1}set delayed(e){}get disabled(){return!1}set disabled(e){}get elementResolver(){return this._elementResolver}set elementResolver(e){this._elementResolver=e}async ensureOnDOM(e){}async makeTransition(e){return null}async manageDelay(e){}async managePopoverOpen(){}managePosition(){}get open(){return!1}set open(e){}get placementController(){return this._placementController}set placementController(e){this._placementController=e}requestSlottable(){}returnFocus(){}get state(){return\"closed\"}set state(e){}manuallyKeepOpen(){}static update(){const e=new CustomEvent(\"sp-update-overlays\",{bubbles:!0,composed:!0,cancelable:!0});document.dispatchEvent(e)}static async open(e,r,n,a){await import(\"@spectrum-web-components/overlay/sp-overlay.js\");const m=arguments.length===2,l=n||e,t=new this;let p=!1;t.dispose=()=>{t.addEventListener(\"sp-closed\",()=>{p||(d(),p=!0),requestAnimationFrame(()=>{t.remove()})}),t.open=!1,t.dispose=noop};const d=b([l],t,{position:\"beforeend\",prepareCallback:s=>{const c=s.slot;return s.removeAttribute(\"slot\"),()=>{s.slot=c}}});if(!m&&l&&a){const s=e,c=r,u=a;return AbstractOverlay.applyOptions(t,{...u,delayed:u.delayed||l.hasAttribute(\"delayed\"),trigger:u.virtualTrigger||s,type:c===\"modal\"?\"modal\":c===\"hover\"?\"hint\":\"auto\"}),s.insertAdjacentElement(\"afterend\",t),await t.updateComplete,t.open=!0,t.dispose}const y=r;return t.append(l),AbstractOverlay.applyOptions(t,{...y,delayed:y.delayed||l.hasAttribute(\"delayed\")}),t.updateComplete.then(()=>{t.open=!0}),t}static applyOptions(e,r){var n,a;e.delayed=!!r.delayed,e.receivesFocus=(n=r.receivesFocus)!=null?n:\"auto\",e.triggerElement=r.trigger||null,e.type=r.type||\"modal\",e.offset=(a=r.offset)!=null?a:0,e.placement=r.placement,e.willPreventClose=!!r.notImmediatelyClosable}disconnectedCallback(){super.disconnectedCallback()}}\n//# sourceMappingURL=AbstractOverlay.js.map\n","\"use strict\";const t=1e3,s=1e3;export class OverlayTimer{constructor(e={}){this.warmUpDelay=1e3;this.coolDownDelay=1e3;this.isWarm=!1;this.timeout=0;Object.assign(this,e)}async openTimer(e){if(this.cancelCooldownTimer(),!this.component||e!==this.component)return this.component&&(this.close(this.component),this.cancelCooldownTimer()),this.component=e,this.isWarm?!1:(this.promise=new Promise(o=>{this.resolve=o,this.timeout=window.setTimeout(()=>{this.resolve&&(this.resolve(!1),this.isWarm=!0)},this.warmUpDelay)}),this.promise);if(this.promise)return this.promise;throw new Error(\"Inconsistent state\")}close(e){this.component&&this.component===e&&(this.resetCooldownTimer(),this.timeout>0&&(clearTimeout(this.timeout),this.timeout=0),this.resolve&&(this.resolve(!0),delete this.resolve),delete this.promise,delete this.component)}resetCooldownTimer(){this.isWarm&&(this.cooldownTimeout&&window.clearTimeout(this.cooldownTimeout),this.cooldownTimeout=window.setTimeout(()=>{this.isWarm=!1,delete this.cooldownTimeout},this.coolDownDelay))}cancelCooldownTimer(){this.cooldownTimeout&&window.clearTimeout(this.cooldownTimeout),delete this.cooldownTimeout}}\n//# sourceMappingURL=overlay-timer.js.map\n","\"use strict\";function T(o,i,l=[]){for(let e=0;e<i.length;++e){const n=i[e],r=o[e],t=r.parentElement||r.getRootNode();l[e]&&l[e](n),t&&t!==r&&t.replaceChild(n,r),delete o[e]}return i}export const reparentChildren=(o,i,{position:l,prepareCallback:e}={position:\"beforeend\"})=>{let{length:n}=o;if(n===0)return()=>o;let r=1,t=0;(l===\"afterbegin\"||l===\"afterend\")&&(r=-1,t=n-1);const a=new Array(n),c=new Array(n),p=document.createComment(\"placeholder for reparented element\");do{const d=o[t];e&&(c[t]=e(d)),a[t]=p.cloneNode();const m=d.parentElement||d.getRootNode();m&&m!==d&&m.replaceChild(a[t],d),i.insertAdjacentElement(l,d),t+=r}while(--n>0);return function(){return T(a,o,c)}};\n//# sourceMappingURL=reparent-children.js.map\n"],"names":["overlayTimer","constructor","e","this","warmUpDelay","coolDownDelay","isWarm","timeout","Object","assign","openTimer","cancelCooldownTimer","component","close","promise","Promise","o","resolve","window","setTimeout","Error","resetCooldownTimer","clearTimeout","cooldownTimeout","noop","guaranteedAllTransitionend","i","v","r","AbortController","n","Map","a","cleanup","abort","m","l","t","requestAnimationFrame","p","target","set","propertyName","get","delete","size","addEventListener","has","cancelAnimationFrame","signal","nextFrame","AbstractOverlay","g","arguments","dispose","offset","willPreventClose","applyFocus","delayed","disabled","elementResolver","_elementResolver","ensureOnDOM","makeTransition","manageDelay","managePopoverOpen","managePosition","open","placementController","_placementController","requestSlottable","returnFocus","state","manuallyKeepOpen","update","CustomEvent","bubbles","composed","cancelable","document","dispatchEvent","import","length","d","remove","reparentChildren","position","prepareCallback","Array","c","createComment","cloneNode","parentElement","getRootNode","replaceChild","insertAdjacentElement","T","b","s","slot","removeAttribute","u","applyOptions","hasAttribute","trigger","virtualTrigger","type","updateComplete","y","append","then","receivesFocus","triggerElement","placement","notImmediatelyClosable","disconnectedCallback","super"],"mappings":"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"}