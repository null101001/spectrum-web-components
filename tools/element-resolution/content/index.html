<html><head></head><body><sp-tab-panel class="section" value="overview"> <div class="headerContainer spectrum-Typography"><h2 id="description" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeL">Description</h2> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeL" href="#description"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Description</span></sp-link><sp-divider size="l"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">An <code class="spectrum-Code">ElementResolutionController</code> keeps an active reference to another element in the same DOM tree. Supply the controller with a selector to query and it will manage observing the DOM tree to ensure that the reference it holds is always the first matched element or <code class="spectrum-Code">null</code>.</p> <div class="headerContainer spectrum-Typography"><h3 id="usage" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeM">Usage</h3> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeM" href="#usage"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Usage</span></sp-link><sp-divider size="m"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM"><sp-link href="https://www.npmjs.com/package/@spectrum-web-components/reactive-controllers"><img src="https://img.shields.io/npm/v/@spectrum-web-components/reactive-controllers?style=for-the-badge" alt="See it on NPM!"></sp-link> <sp-link href="https://bundlephobia.com/result?p=@spectrum-web-components/reactive-controllers"><img src="https://img.shields.io/bundlephobia/minzip/@spectrum-web-components/reactive-controllers?style=for-the-badge" alt="How big is this package in your project?"></sp-link></p> <code-example preprocessed="preprocessed"><pre slot="code">yarn add @spectrum-web-components/reactive-controllers
</pre></code-example> <p class="spectrum-Body spectrum-Body--sizeM">Import the <code class="spectrum-Code">ElementResolutionController</code> and/or <code class="spectrum-Code">elementResolverUpdatedSymbol</code> via:</p> <code-example preprocessed="preprocessed"><pre slot="code">import { ElementResolutionController, elementResolverUpdatedSymbol } from '@spectrum-web-components/reactive-controllers/ElementResolution.js';
</pre></code-example> <div class="headerContainer spectrum-Typography"><h2 id="example" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeL">Example</h2> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeL" href="#example"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Example</span></sp-link><sp-divider size="l"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">An <code class="spectrum-Code">ElementResolutionController</code> can be applied to a host element like the following.</p> <code-example class="language-js" preprocessed="preprocessed"><pre class="language-js" slot="code"><span class="token keyword">import</span> <span class="token punctuation">{</span> html<span class="token punctuation">,</span> LitElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lit'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ElementResolutionController <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@spectrum-web-components/reactive-controllers/ElementResolution.js'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">RootEl</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span>
    resolvedElement <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ElementResolutionController</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">costructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>resolvedElement<span class="token punctuation">.</span>selector <span class="token operator">=</span> <span class="token string">'.other-element'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'root-el'</span><span class="token punctuation">,</span> RootEl<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></code-example> <p class="spectrum-Body spectrum-Body--sizeM">In this example, the selector <code class="spectrum-Code">'.other-element'</code> is supplied to the resolver, which mean in the following example, <code class="spectrum-Code">this.resolvedElement.element</code> will maintain a reference to the sibling <code class="spectrum-Code">&lt;div&gt;</code> element:</p> <code-example class="language-html-no-demo" preprocessed="preprocessed"><pre class="language-html-no-demo" slot="code"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root-el</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root-el</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>other-element<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></pre></code-example> <p class="spectrum-Body spectrum-Body--sizeM">The resolved reference will always be the first element matching the selector applied, so in the following example the element with content "First!" will be the reference:</p> <code-example class="language-html-no-demo" preprocessed="preprocessed"><pre class="language-html-no-demo" slot="code"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root-el</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root-el</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>other-element<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>First!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>other-element<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Last.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></pre></code-example> <p class="spectrum-Body spectrum-Body--sizeM">A <sp-link href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver"><code class="spectrum-Code">MutationObserver</code></sp-link> is leveraged to track mutations to the DOM tree in which the host element resides in order to update the element reference on any changes to the content therein that could change the resolved element.</p> <div class="headerContainer spectrum-Typography"><h2 id="updates" tabindex="-1" class="header-heading spectrum-Heading spectrum-Heading--sizeL">Updates</h2> <sp-link class="header-anchor spectrum-Heading spectrum-Heading--sizeL" href="#updates"><span aria-hidden="true">#</span><span class="visually-hidden">Section titled Updates</span></sp-link><sp-divider size="l"></sp-divider></div><p class="spectrum-Body spectrum-Body--sizeM">Changes to the resolved element reference are reported to the host element via a call to the <code class="spectrum-Code">requestUpdate()</code> method. This will be provided the <code class="spectrum-Code">elementResolverUpdatedSymbol</code> as the changed key. If your element leverages this value against the changes map, it can react directly to changes in the resolved element:</p> <code-example class="language-ts" preprocessed="preprocessed"><pre class="language-ts" slot="code"><span class="token keyword">import</span> <span class="token punctuation">{</span> html<span class="token punctuation">,</span> LitElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'lit'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
    ElementResolutionController<span class="token punctuation">,</span>
    elementResolverUpdatedSymbol<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@spectrum-web-components/reactive-controllers/ElementResolution.js'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">RootEl</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span>
    resolvedElement <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ElementResolutionController</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">costructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>resolvedElement<span class="token punctuation">.</span>selector <span class="token operator">=</span> <span class="token string">'.other-element'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> override <span class="token function">willUpdate</span><span class="token punctuation">(</span>changes<span class="token operator">:</span> PropertyValues<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>changes<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>elementResolverUpdatedSymbol<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// work to be done only when the element reference has been updated</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></pre></code-example> </sp-tab-panel></body></html>